<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE HUNT - Christmas Edition</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="stylesheet" href="styles.css?v=20241010-6">
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="snow-container">
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
        <div class="snow"></div>
    </div>
    
    <div class="container">
        <header class="header">
            <h1 class="main-title">THE HUNT</h1>
            <div class="subtitle">
                <p class="christmas-greeting">Merry Christmas everyone.</p>
                <p class="instructions">Find the clues, have fun and good luck.</p>
				<p class="instructions">Click Play on all videos and turn up the sound!.</p>
            </div>
        </header>
        
        <main class="main-content">
            <div class="video-container">
                <iframe width="1200" height="675" src="https://www.youtube.com/embed/E8gmARGvPlI?si=JfaOW8U-XVFAW-tM&autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
            
            <div class="decorations">
                <!-- Target elements - correct order: blade then runner -->
                <div class="clickable-icon blade-icon" data-type="blade">⛸️</div>
                <div class="clickable-icon runner-icon" data-type="runner">🏃</div>
                
                <!-- Christmas decorations -->
                <div class="clickable-icon christmas-icon">🎄</div>
                <div class="clickable-icon christmas-icon">⭐</div>
                <div class="clickable-icon christmas-icon">🎁</div>
                <div class="clickable-icon christmas-icon">❄️</div>
                <div class="clickable-icon christmas-icon">🔔</div>
                <div class="clickable-icon christmas-icon">🎅</div>
                <div class="clickable-icon christmas-icon">🤶</div>
                <div class="clickable-icon christmas-icon">🦌</div>
                <div class="clickable-icon christmas-icon">🛷</div>
                <div class="clickable-icon christmas-icon">🕯️</div>
                <div class="clickable-icon christmas-icon">🧸</div>
                <div class="clickable-icon christmas-icon">🎂</div>
                <div class="clickable-icon christmas-icon">🍪</div>
                <div class="clickable-icon christmas-icon">🥛</div>
                <div class="clickable-icon christmas-icon">🎪</div>
                <div class="clickable-icon christmas-icon">🎭</div>
            </div>
            
            <!-- Success modal -->
            <div id="successModal" class="modal">
                <div class="modal-content">
                    <h2>🎉 Well Done! 🎉</h2>
                    <p>You found the correct sequence!</p>
                    <p>Redirecting to next page in: <span id="countdown">5</span> seconds</p>
                </div>
            </div>
        </main>
        
        <footer class="footer">
            <p>🎅 Happy Hunting! 🎅</p>
        </footer>
    </div>
    
    <script>
        let clickSequence = [];
        let sequenceTimer = null;
        let christmasSound = new Audio('https://cdn.uppbeat.io/audio-files/55d19f5556f7b9b464f7db2307b60edb/019ab3e35656db3930cde809d1d44ff2/7b827010c64f74718a261c1273fdbc1d/STREAMING-ho-ho-ho-santa-chuckle-david-h-m-lambert-2-2-00-02.mp3');
        let bellSound = new Audio('https://cdn.uppbeat.io/audio-files/550fafd5d5403a2f6e11b6feefd0899e/d45093cdcae74eb6d489bb61fcd54c55/9750ea2f8e377962181d8aab82cba169/STREAMING-christmas-bells-shaken-gfx-sounds-3-3-00-01.mp3');
        
        // Preload audio
        christmasSound.preload = 'auto';
        bellSound.preload = 'auto';
        christmasSound.volume = 0.7;
        bellSound.volume = 0.7;
        
        function resetSequence() {
            clickSequence = [];
            if (sequenceTimer) {
                clearTimeout(sequenceTimer);
                sequenceTimer = null;
            }
            console.log('Sequence reset');
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const clickableIcons = document.querySelectorAll('.clickable-icon');
            const modal = document.getElementById('successModal');
            const countdownElement = document.getElementById('countdown');
            const videoContainer = document.querySelector('.video-container');
            
            // Position icons randomly outside video area
            function positionIcon(icon) {
                const videoRect = videoContainer.getBoundingClientRect();
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                
                let x, y;
                const attempts = 50;
                let attempt = 0;
                
                do {
                    x = Math.random() * (windowWidth - 100);
                    y = Math.random() * (windowHeight - 100);
                    attempt++;
                } while (attempt < attempts && 
                         x > videoRect.left - 50 && 
                         x < videoRect.right + 50 && 
                         y > videoRect.top - 50 && 
                         y < videoRect.bottom + 50);
                
                icon.style.position = 'fixed';
                icon.style.left = x + 'px';
                icon.style.top = y + 'px';
                icon.style.cursor = 'pointer';
                icon.style.fontSize = '2.5rem';
                icon.style.zIndex = '15';
                icon.style.animation = 'float 3s ease-in-out infinite';
                icon.style.animationDelay = Math.random() * 2 + 's';
            }
            
            // Initial positioning and random repositioning
            clickableIcons.forEach(icon => {
                positionIcon(icon);
                
                // Random disappear/reappear cycle
                function startRandomCycle() {
                    const disappearTime = Math.random() * 3000 + 2000; // 2-5 seconds
                    const reappearTime = Math.random() * 2000 + 1000; // 1-3 seconds
                    
                    setTimeout(() => {
                        icon.style.opacity = '0';
                        icon.style.transform = 'scale(0)';
                        
                        setTimeout(() => {
                            positionIcon(icon);
                            icon.style.opacity = '1';
                            icon.style.transform = 'scale(1)';
                            startRandomCycle(); // Continue the cycle
                        }, reappearTime);
                    }, disappearTime);
                }
                
                startRandomCycle();
                
                icon.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    console.log('Clicked:', type, 'Current sequence:', clickSequence);
                    
                    if (type === 'blade' || type === 'runner') {
                        try {
                            bellSound.currentTime = 0;
                            bellSound.play().catch(e => console.log('Bell sound failed:', e));
                        } catch(e) {
                            console.log('Bell sound error:', e);
                        }
                        
                        // Handle blade click
                        if (type === 'blade') {
                            if (clickSequence.length === 0) {
                                clickSequence.push(type);
                                console.log('Blade clicked first - starting timer');
                                
                                // Start 10-second timer
                                sequenceTimer = setTimeout(() => {
                                    console.log('10 seconds expired - resetting sequence');
                                    resetSequence();
                                }, 10000);
                            } else {
                                // Wrong sequence or blade clicked again
                                console.log('Wrong sequence - blade clicked at wrong time');
                                resetSequence();
                            }
                        }
                        // Handle runner click
                        else if (type === 'runner') {
                            if (clickSequence.length === 1 && clickSequence[0] === 'blade') {
                                clickSequence.push(type);
                                console.log('Correct sequence completed!');
                                clearTimeout(sequenceTimer);
                                showSuccessModal();
                            } else {
                                // Wrong sequence - runner clicked without blade first
                                console.log('Wrong sequence - runner clicked without blade first');
                                resetSequence();
                            }
                        }
                    } else {
                        // Christmas decoration clicked
                        try {
                            christmasSound.currentTime = 0;
                            christmasSound.play().catch(e => console.log('Christmas sound failed:', e));
                        } catch(e) {
                            console.log('Christmas sound error:', e);
                        }
                        // Reset sequence on wrong click
                        console.log('Christmas decoration clicked - resetting sequence');
                        resetSequence();
                    }
                });
            });
            
            function showSuccessModal() {
                resetSequence(); // Clear any timers and reset sequence
                modal.style.display = 'flex';
                let countdown = 5;
                
                const timer = setInterval(() => {
                    countdown--;
                    countdownElement.textContent = countdown;
                    
                    if (countdown <= 0) {
                        clearInterval(timer);
                        window.location.href = 'blade-runner.html';
                    }
                }, 1000);
            }
        });
    </script>
</body>
</html>